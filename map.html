<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RouteRush Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
  <link rel="stylesheet" href="https://unpkg.com/awesomplete/awesomplete.css">
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; background: #f0f8ff; }
    h1 { text-align: center; margin: 20px 0; color: #007B8F; }
    nav {
      background: #007B8F; padding: 12px; text-align: center;
    }
    nav a {
      color: #fff; margin: 0 15px; text-decoration: none; font-weight: bold;
    }
    #map { height: 450px; margin: 20px; border-radius: 10px; }
    input, button {
      padding: 10px; margin: 5px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;
    }
    button {
      background: #FF5E00; color: #fff; border: none;
    }
    button:hover { background: #e04d00; cursor: pointer; }
    #output, #funFact { text-align: center; margin: 10px auto; font-size: 16px; }
    #weatherBox {
      margin:20px auto; text-align:center; background:#e0f7fa;
      padding:15px; border-radius:10px; max-width:400px;
    }
    #adBanner {
      margin:20px auto; text-align:center;
    }
    #adBanner p {
      background:#ffefc3; padding:10px; border:1px solid #ccc; border-radius:5px; display:inline-block;
    }
  </style>
</head>
<body>

<nav>
  <a href="index.html">Home</a>
  <a href="map.html">Map</a>
  <a href="gallery.html">Gallery</a>
  <a href="blog.html">Blog</a>
  <a href="contact.html">Contact</a>
</nav>

<h1>üìç RouteRush Map & Distance Finder</h1>

<div style="text-align:center;">
  <input id="fromPlace" placeholder="From" class="awesomplete">
  <input id="toPlace" placeholder="To" class="awesomplete">
  <button onclick="showRoute()">Show Route</button>
</div>

<div id="output"></div>
<div id="funFact"></div>
<div id="map"></div>

<div id="weatherBox">
  <h3>üå§Ô∏è Weather at Destination</h3>
  <p id="weatherInfo">Weather will appear after routing.</p>
</div>

<div id="adBanner">
  <p>Your AdSense Banner Here</p>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/awesomplete/awesomplete.min.js"></script>

<script>
  const map = L.map('map').setView([15, 75], 6);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '¬© OpenStreetMap' }).addTo(map);
  let routeLayer;

  const fromInput = document.getElementById("fromPlace");
  const toInput = document.getElementById("toPlace");
  new Awesomplete(fromInput);
  new Awesomplete(toInput);

  function fetchSuggestions(input) {
    input.addEventListener("input", () => {
      if (input.value.length < 3) return;
      fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(input.value)}`)
        .then(res => res.json())
        .then(data => {
          const list = data.map(item => item.display_name);
          input.awesomplete.list = list;
        });
    });
  }
  fetchSuggestions(fromInput);
  fetchSuggestions(toInput);

  function showRoute() {
    const from = fromInput.value, to = toInput.value;
    if (!from || !to) { alert("Enter both places"); return; }

    Promise.all([
      fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(from)}`).then(r => r.json()),
      fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(to)}`).then(r => r.json())
    ]).then(([fromData, toData]) => {
      if (!fromData[0] || !toData[0]) { alert("Places not found."); return; }
      const fromCoords = [fromData[0].lat, fromData[0].lon];
      const toCoords = [toData[0].lat, toData[0].lon];

      fetch(`https://router.project-osrm.org/route/v1/driving/${fromCoords[1]},${fromCoords[0]};${toCoords[1]},${toCoords[0]}?overview=full&geometries=geojson`)
        .then(r => r.json())
        .then(routeData => {
          if (routeData.code !== 'Ok') { alert("Route not found."); return; }

          const route = routeData.routes[0];
          const distance = (route.distance / 1000).toFixed(2);
          const durationMins = Math.round(route.duration / 60);
          const hours = Math.floor(durationMins / 60);
          const mins = durationMins % 60;
          const durationText = hours > 0 ? `${hours} hr ${mins} min` : `${mins} min`;

          document.getElementById("output").innerText = `Distance: ${distance} km | Duration: ${durationText}`;

          if (routeLayer) map.removeLayer(routeLayer);
          routeLayer = L.geoJSON(route.geometry, { color: 'blue' }).addTo(map);
          map.fitBounds(L.geoJSON(route.geometry).getBounds());

          fetchWeather(to);
        });
    });
  }

  function fetchWeather(city) {
    fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&appid=02913f6d96135db7a1f6cdbfca5a1792&units=metric`)
      .then(response => response.json())
      .then(data => {
        const temp = data.main.temp;
        const desc = data.weather[0].description;
        const icon = data.weather[0].icon;
        document.getElementById("weatherInfo").innerHTML = `
          <img src="https://openweathermap.org/img/wn/${icon}@2x.png" alt="Icon"><br>
          <strong>${city}</strong>: ${temp}¬∞C, ${desc}
        `;
      })
      .catch(() => {
        document.getElementById("weatherInfo").innerText = "Weather unavailable.";
      });
  }

  const facts = [
    "India has the world‚Äôs highest cricket ground at Chail, Himachal Pradesh.",
    "The Great Wall of China is visible from space ‚Äî but only under specific conditions.",
    "Lake Baikal in Russia holds 20% of the world‚Äôs fresh water.",
    "The Amazon rainforest produces 20% of the world's oxygen supply.",
    "The world‚Äôs longest road is the Pan-American Highway spanning 19,000 miles."
  ];

  function showRandomFact() {
    const fact = facts[Math.floor(Math.random() * facts.length)];
    document.getElementById("funFact").innerText = `üí° Fun Fact: ${fact}`;
  }

  showRandomFact();
  setInterval(showRandomFact, 10000);
</script>

</body>
</html>
